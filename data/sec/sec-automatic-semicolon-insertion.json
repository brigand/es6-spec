{"id":"sec-automatic-semicolon-insertion","html":"\n    <div class=\"front\">\n      <h1><span class=\"secnum\" id=\"sec-11.9\"><a href=\"/sec/sec-automatic-semicolon-insertion.html\" title=\"link to this section\">11.9</a></span> Automatic Semicolon Insertion</h1>\n\n      <p>Certain ECMAScript statements (empty statement, <code>let</code>, <code>const</code>, <code>import</code>, and\n      <code>export</code> declarations, variable statement, expression statement, <code>debugger</code> statement,\n      <code>continue</code> statement, <code>break</code> statement, <code>return</code> statement, and <code>throw</code>\n      statement) must be terminated with semicolons. Such semicolons may always appear explicitly in the source text. For\n      convenience, however, such semicolons may be omitted from the source text in certain situations. These situations are\n      described by saying that semicolons are automatically inserted into the source code token stream in those situations.</p>\n    </div>\n\n    <section id=\"sec-rules-of-automatic-semicolon-insertion\">\n      <h1><span class=\"secnum\" id=\"sec-11.9.1\"><a href=\"/sec/sec-rules-of-automatic-semicolon-insertion.html\" title=\"link to this section\">11.9.1</a></span> Rules of Automatic Semicolon Insertion</h1>\n\n      <p>In the following rules, &#x201C;token&#x201D; means the actual recognized lexical token determined using the current\n      lexical goal symbol as described in <a href=\"/sec/sec-ecmascript-language-lexical-grammar.html\">clause 11</a>.</p>\n\n      <p>There are three basic rules of semicolon insertion:</p>\n\n      <ol class=\"proc\">\n        <li>When, as a <span style=\"font-family: Times New Roman\"><i>Script</i> or <i>Module</i></span> is parsed from left to\n            right, a token (called the <i>offending token</i>) is encountered that is not allowed by any production of the\n            grammar, then a semicolon is automatically inserted before the offending token if one or more of the following\n            conditions is true:\n          <ul>\n            <li>\n              <p>The offending token is separated from the previous token by at least one <span class=\"nt\">LineTerminator</span>.</p>\n            </li>\n\n            <li>\n              <p>The offending token is <code>}</code>.</p>\n            </li>\n\n            <li>\n              <p>The previous token is <code>)</code> and the inserted semicolon would then be parsed as the terminating semicolon\n              of a do-while statement (<a href=\"/sec/sec-do-while-statement.html\">13.7.2</a>).</p>\n            </li>\n          </ul>\n        </li>\n        <li>When, as the <span style=\"font-family: Times New Roman\"><i>Script</i> or <i>Module</i></span> is parsed from left to\n            right, the end of the input stream of tokens is encountered and the parser is unable to parse the input token stream\n            as a single complete ECMAScript <span style=\"font-family: Times New Roman\"><i>Script</i> or <i>Module</i></span>, then\n            a semicolon is automatically inserted at the end of the input stream.</li>\n        <li>When, as the <span style=\"font-family: Times New Roman\"><i>Script</i> or <i>Module</i></span> is parsed from left to\n            right, a token is encountered that is allowed by some production of the grammar, but the production is a <i>restricted\n            production</i> and the token would be the first token for a terminal or nonterminal immediately following the\n            annotation <span style=\"font-family: Times New Roman\">&#x201C;</span>[no<span style=\"font-family: Times New\n            Roman\">&#xA0;<i>LineTerminator</i></span> here]&#x201D; within the restricted production (and therefore such a token is\n            called a restricted token), and the restricted token is separated from the previous token by at least one <span class=\"nt\">LineTerminator</span>, then a semicolon is automatically inserted before the restricted token.</li>\n      </ol>\n\n      <p>However, there is an additional overriding condition on the preceding rules: a semicolon is never inserted automatically\n      if the semicolon would then be parsed as an empty statement or if that semicolon would become one of the two semicolons in\n      the header of a <code>for</code> statement (<a href=\"/sec/sec-for-statement.html\">see 13.7.4</a>).</p>\n\n      <div class=\"note\">\n        <p><span class=\"nh\">NOTE</span> The following are the only restricted productions in the grammar:</p>\n\n        <div class=\"gp\">\n          <div class=\"lhs\"><span class=\"nt\">PostfixExpression</span><sub class=\"g-params\">[Yield]</sub> <span class=\"geq\">:</span></div>\n          <div class=\"rhs\"><span class=\"nt\">LeftHandSideExpression</span><sub class=\"g-params\">[?Yield]</sub> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <code class=\"t\">++</code></div>\n          <div class=\"rhs\"><span class=\"nt\">LeftHandSideExpression</span><sub class=\"g-params\">[?Yield]</sub> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <code class=\"t\">--</code></div>\n        </div>\n\n        <div class=\"gp\">\n          <div class=\"lhs\"><span class=\"nt\">ContinueStatement</span><sub class=\"g-params\">[Yield]</sub> <span class=\"geq\">:</span></div>\n          <div class=\"rhs\"><code class=\"t\">continue;</code></div>\n          <div class=\"rhs\"><code class=\"t\">continue</code> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <span class=\"nt\">LabelIdentifier</span><sub class=\"g-params\">[?Yield]</sub> <code class=\"t\">;</code></div>\n        </div>\n\n        <div class=\"gp\">\n          <div class=\"lhs\"><span class=\"nt\">BreakStatement</span><sub class=\"g-params\">[Yield]</sub> <span class=\"geq\">:</span></div>\n          <div class=\"rhs\"><code class=\"t\">break</code> <code class=\"t\">;</code></div>\n          <div class=\"rhs\"><code class=\"t\">break</code> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <span class=\"nt\">LabelIdentifier</span><sub class=\"g-params\">[?Yield]</sub> <code class=\"t\">;</code></div>\n        </div>\n\n        <div class=\"gp\">\n          <div class=\"lhs\"><span class=\"nt\">ReturnStatement</span><sub class=\"g-params\">[Yield]</sub> <span class=\"geq\">:</span></div>\n          <div class=\"rhs\"><code class=\"t\">return</code> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <span class=\"nt\">Expression</span> <code class=\"t\">;</code></div>\n          <div class=\"rhs\"><code class=\"t\">return</code> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <span class=\"nt\">Expression</span><sub class=\"g-params\">[In, ?Yield]</sub> <code class=\"t\">;</code></div>\n        </div>\n\n        <div class=\"gp\">\n          <div class=\"lhs\"><span class=\"nt\">ThrowStatement</span><sub class=\"g-params\">[Yield]</sub> <span class=\"geq\">:</span></div>\n          <div class=\"rhs\"><code class=\"t\">throw</code> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <span class=\"nt\">Expression</span><sub class=\"g-params\">[In, ?Yield]</sub> <code class=\"t\">;</code></div>\n        </div>\n\n        <div class=\"gp\">\n          <div class=\"lhs\"><span class=\"nt\">ArrowFunction</span><sub class=\"g-params\">[In, Yield]</sub> <span class=\"geq\">:</span></div>\n          <div class=\"rhs\"><span class=\"nt\">ArrowParameters</span><sub class=\"g-params\">[?Yield]</sub> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <code class=\"t\">=&gt;</code> <span class=\"nt\">ConciseBody</span><sub class=\"g-params\">[?In]</sub></div>\n        </div>\n\n        <div class=\"gp\">\n          <div class=\"lhs\"><span class=\"nt\">YieldExpression</span><sub class=\"g-params\">[In]</sub> <span class=\"geq\">:</span></div>\n          <div class=\"rhs\"><code class=\"t\">yield</code> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <code class=\"t\">*</code> <span class=\"nt\">AssignmentExpression</span><sub class=\"g-params\">[?In, Yield]</sub></div>\n          <div class=\"rhs\"><code class=\"t\">yield</code> <span class=\"grhsannot\">[no <span class=\"nt\">LineTerminator</span> here]</span> <span class=\"nt\">AssignmentExpression</span><sub class=\"g-params\">[?In, Yield]</sub></div>\n        </div>\n\n        <p>The practical effect of these restricted productions is as follows:</p>\n\n        <ul>\n          <li>\n            <p>When a <code>++</code> or <code>--</code> token is encountered where the parser would treat it as a postfix\n            operator, and at least one <span class=\"nt\">LineTerminator</span> occurred between the preceding token and the\n            <code>++</code> or <code>--</code> token, then a semicolon is automatically inserted before the <code>++</code> or\n            <code>--</code> token.</p>\n          </li>\n\n          <li>\n            <p>When a <code>continue</code>, <code>break</code>, <code>return</code>, <code>throw</code>, or <code>yield</code>\n            token is encountered and a <span class=\"nt\">LineTerminator</span> is encountered before the next token, a semicolon is\n            automatically inserted after the <code>continue</code>, <code>break</code>, <code>return</code>, <code>throw</code>,\n            or <code>yield</code>  token.</p>\n          </li>\n        </ul>\n\n        <p>The resulting practical advice to ECMAScript programmers is:</p>\n\n        <ul>\n          <li>\n            <p>A postfix <code>++</code> or <code>--</code> operator should appear on the same line as its operand.</p>\n          </li>\n\n          <li>\n            <p>An <span class=\"nt\">Expression</span> in a <code>return</code> or <code>throw</code> statement or an <span class=\"nt\">AssignmentExpression</span> in a <code>yield</code> expression should start on the same line as the\n            <code>return</code>, <code>throw</code>, or <code>yield</code> token.</p>\n          </li>\n\n          <li>\n            <p>An <span class=\"nt\">IdentifierReference</span> in a <code>break</code> or <code>continue</code> statement should be\n            on the same line as the <code>break</code> or <code>continue</code> token.</p>\n          </li>\n        </ul>\n      </div>\n    </section>\n\n    <section id=\"sec-examples-of-automatic-semicolon-insertion\">\n      <h1><span class=\"secnum\" id=\"sec-11.9.2\"><a href=\"/sec/sec-examples-of-automatic-semicolon-insertion.html\" title=\"link to this section\">11.9.2</a></span> Examples of Automatic Semicolon Insertion</h1>\n\n      <p>The source</p>\n\n      <pre class=\"NoteCode\">{ 1 2 } 3</pre>\n\n      <p>is not a valid sentence in the ECMAScript grammar, even with the <a href=\"/sec/sec-automatic-semicolon-insertion.html\">automatic\n      semicolon insertion</a> rules. In contrast, the source</p>\n\n      <pre class=\"NoteCode\">{ 1<br>2 } 3</pre>\n\n      <p>is also not a valid ECMAScript sentence, but is transformed by <a href=\"/sec/sec-automatic-semicolon-insertion.html\">automatic\n      semicolon insertion</a> into the following:</p>\n\n      <pre class=\"NoteCode\">{ 1<br>;2 ;} 3;</pre>\n\n      <p>which is a valid ECMAScript sentence.</p>\n\n      <p>The source</p>\n\n      <pre class=\"NoteCode\">for (a; b<br>)</pre>\n\n      <p>is not a valid ECMAScript sentence and is not altered by <a href=\"/sec/sec-automatic-semicolon-insertion.html\">automatic semicolon\n      insertion</a> because the semicolon is needed for the header of a <code>for</code> statement. Automatic semicolon insertion\n      never inserts one of the two semicolons in the header of a <code>for</code> statement.</p>\n\n      <p>The source</p>\n\n      <pre class=\"NoteCode\">return<br>a + b</pre>\n\n      <p>is transformed by <a href=\"/sec/sec-automatic-semicolon-insertion.html\">automatic semicolon insertion</a> into the following:</p>\n\n      <pre class=\"NoteCode\">return;<br>a + b;</pre>\n\n      <div class=\"note\">\n        <p><span class=\"nh\">NOTE 1</span> The expression <code>a + b</code> is not treated as a value to be returned by the\n        <code>return</code> statement, because a <span class=\"nt\">LineTerminator</span> separates it from the token\n        <code>return</code>.</p>\n      </div>\n\n      <p>The source</p>\n\n      <pre class=\"NoteCode\">a = b<br>++c</pre>\n\n      <p>is transformed by <a href=\"/sec/sec-automatic-semicolon-insertion.html\">automatic semicolon insertion</a> into the following:</p>\n\n      <pre class=\"NoteCode\">a = b;<br>++c;</pre>\n\n      <div class=\"note\">\n        <p><span class=\"nh\">NOTE 2</span> The token <code>++</code> is not treated as a postfix operator applying to the variable\n        <code>b</code>, because a <span class=\"nt\">LineTerminator</span> occurs between <code>b</code> and <code>++</code>.</p>\n      </div>\n\n      <p>The source</p>\n\n      <pre class=\"NoteCode\">if (a &gt; b)<br>else c = d</pre>\n\n      <p>is not a valid ECMAScript sentence and is not altered by <a href=\"/sec/sec-automatic-semicolon-insertion.html\">automatic semicolon\n      insertion</a> before the <code>else</code> token, even though no production of the grammar applies at that point, because an\n      automatically inserted semicolon would then be parsed as an empty statement.</p>\n\n      <p>The source</p>\n\n      <pre class=\"NoteCode\">a = b + c<br>(d + e).print()</pre>\n\n      <p>is <i>not</i> transformed by <a href=\"/sec/sec-automatic-semicolon-insertion.html\">automatic semicolon insertion</a>, because the\n      parenthesized expression that begins the second line can be interpreted as an argument list for a function call:</p>\n\n      <pre class=\"NoteCode\">a = b + c(d + e).print()</pre>\n\n      <p>In the circumstance that an assignment statement must begin with a left parenthesis, it is a good idea for the programmer\n      to provide an explicit semicolon at the end of the preceding statement rather than to rely on <a href=\"/sec/sec-automatic-semicolon-insertion.html\">automatic semicolon insertion</a>.</p>\n    </section>\n  "}