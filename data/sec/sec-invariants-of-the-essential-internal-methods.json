{"id":"sec-invariants-of-the-essential-internal-methods","html":"\n        <h1><span class=\"secnum\" id=\"sec-6.1.7.3\"><a href=\"/sec/sec-invariants-of-the-essential-internal-methods.html\" title=\"link to this section\">6.1.7.3</a></span> Invariants of the Essential Internal Methods</h1>\n\n        <p>The Internal Methods of Objects of an ECMAScript engine must conform to the list of invariants specified below.\n        Ordinary ECMAScript Objects as well as all standard exotic objects in this specification maintain these invariants.\n        ECMAScript Proxy objects maintain these invariants by means of runtime checks on the result of traps invoked on the\n        [[ProxyHandler]] object.</p>\n\n        <p>Any implementation provided exotic objects must also maintain these invariants for those objects. Violation of these\n        invariants may cause ECMAScript code to have unpredictable behaviour and create security issues. However, violation of\n        these invariants must never compromise the memory safety of an implementation.</p>\n\n        <p>An implementation must not allow these invariants to be circumvented in any manner such as by providing alternative\n        interfaces that implement the functionality of the essential internal methods without enforcing their invariants.</p>\n\n        <p class=\"normalbefore\">Definitions:</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The <i>target</i> of an internal method is the object upon which the\n        internal method is called.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;A target is <i>non-extensible</i> if it has been observed to return\n        false from its [[IsExtensible]] internal method, or true from its [[PreventExtensions]] internal method.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;A <i>non-existent</i> property is a property that does not exist as an\n        own property on a non-extensible target.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;All references to <i><a href=\"/sec/sec-samevalue.html\">SameValue</a></i> are\n        according to the definition of <a href=\"/sec/sec-samevalue.html\">SameValue</a> algorithm specified in <a href=\"/sec/sec-samevalue.html\">7.2.9</a>.</p>\n\n        <p class=\"normalbefore\"><b>[[GetPrototypeOf]] ( )</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be either Object or Null.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If target is non-extensible, and [[GetPrototypeOf]] returns a value v,\n        then any future calls to [[GetPrototypeOf]] should return the <a href=\"/sec/sec-samevalue.html\">SameValue</a> as v.</p>\n\n        <div class=\"note\">\n          <p><span class=\"nh\">NOTE 1</span> An object&#x2019;s prototype chain should have finite length (that is, starting from\n          any object, recursively applying the [[GetPrototypeOf]] internal method to its result should eventually lead to the\n          value null). However, this requirement is not enforceable as an object level invariant if the prototype chain includes\n          any exotic objects that do not use the ordinary object definition of [[GetPrototypeOf]]. Such a circular prototype chain\n          may result in infinite loops when accessing object properties.</p>\n        </div>\n\n        <p class=\"normalbefore\"><b>[[SetPrototypeOf]] (V)</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be Boolean.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If target is non-extensible, [[SetPrototypeOf]] must return false,\n        unless V is the <a href=\"/sec/sec-samevalue.html\">SameValue</a> as the target&#x2019;s observed [[GetPrototypeOf]] value.</p>\n\n        <p class=\"normalbefore\"><b>[[PreventExtensions]] ( )</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be Boolean.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If [[PreventExtensions]] returns true, all future calls to\n        [[IsExtensible]] on the target must return false and the target is now considered non-extensible.</p>\n\n        <p class=\"normalbefore\"><b>[[GetOwnProperty]] (P)</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be either <a href=\"/sec/sec-property-descriptor-specification-type.html\">Property Descriptor</a> or Undefined.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If the Type of the return value is <a href=\"/sec/sec-property-descriptor-specification-type.html\">Property Descriptor</a>, the return value must be a complete property\n        descriptor (<a href=\"/sec/sec-completepropertydescriptor.html\">see 6.2.4.6</a>).</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If a property P is described as a data property with Desc.[[Value]]\n        equal to v and Desc.[[Writable]] and Desc.[[Configurable]] are both false, then the <a href=\"/sec/sec-samevalue.html\">SameValue</a>\n        must be returned for the Desc.[[Value]] attribute of the property on all future calls to [[GetOwnProperty]] ( P ).</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If P&#x2019;s attributes other than [[Writable]] may change over time or\n        if the property might disappear, then P&#x2019;s [[Configurable]] attribute must be true.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If the [[Writable]] attribute may change from false to true, then the\n        [[Configurable]] attribute must be true.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If the target is non-extensible and P is non-existent, then all future\n        calls to [[GetOwnProperty]] (P)  on the target must describe P as non-existent (i.e. [[GetOwnProperty]] (P) must return\n        undefined).</p>\n\n        <div class=\"note\">\n          <p><span class=\"nh\">NOTE 2</span> As a consequence of the third invariant, if a property is described as a data property\n          and it may return different values over time, then either or both of the Desc.[[Writable]] and Desc.[[Configurable]]\n          attributes must be true even if no mechanism to change the value is exposed via the other internal methods.</p>\n        </div>\n\n        <p class=\"normalbefore\"><b>[[DefineOwnProperty]] (P, Desc)</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be Boolean.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;[[DefineOwnProperty]] must return false if P has previously been\n        observed as a non-configurable own property of the target, unless either:</p>\n\n        <p class=\"normalBulletSubstep\">1.\tP is a non-configurable writable own data property. A non-configurable writable data\n        property can be changed into a non-configurable non-writable data property.</p>\n\n        <p class=\"normalBulletSubstep\">2.\tAll attributes in Desc are the <a href=\"/sec/sec-samevalue.html\">SameValue</a> as P&#x2019;s\n        attributes.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;[[DefineOwnProperty]] (P, Desc) must return false if target is\n        non-extensible and P is a non-existent own property. That is, a non-extensible target object cannot be extended with new\n        properties.</p>\n\n        <p class=\"normalbefore\"><b>[[HasProperty]] ( P )</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be Boolean.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If P was previously observed as a non-configurable data or accessor own\n        property of the target, [[HasProperty]] must return true.</p>\n\n        <p class=\"normalbefore\"><b>[[Get]] (P, Receiver)</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If P was previously observed as a non-configurable, non-writable own\n        data property of the target with value v, then [[Get]] must return the <a href=\"/sec/sec-samevalue.html\">SameValue</a>.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If P was previously observed as a non-configurable own accessor property\n        of the target whose [[Get]] attribute is undefined, the [[Get]] operation must return undefined.</p>\n\n        <p class=\"normalbefore\"><b>[[Set]] ( P, V, Receiver)</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be Boolean.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If P was previously observed as a non-configurable, non-writable own\n        data property of the target, then [[Set]] must return false unless V is the <a href=\"/sec/sec-samevalue.html\">SameValue</a> as\n        P&#x2019;s [[Value]] attribute.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If P was previously observed as a non-configurable own accessor property\n        of the target whose [[Set]] attribute is undefined, the [[Set]] operation must return false.</p>\n\n        <p class=\"normalbefore\"><b>[[Delete]] ( P )</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be Boolean.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If P was previously observed to be a non-configurable own data or\n        accessor property of the target, [[Delete]] must return false.</p>\n\n        <p class=\"normalbefore\"><b>[[Enumerate]] ( )</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be Object.</p>\n\n        <p class=\"normalbefore\"><b>[[OwnPropertyKeys]] ( )</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The return value must be a <a href=\"/sec/sec-list-and-record-specification-type.html\">List</a>.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of each element of the returned <a href=\"/sec/sec-list-and-record-specification-type.html\">List</a> is either String or Symbol.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The returned <a href=\"/sec/sec-list-and-record-specification-type.html\">List</a>\n        must contain at least the keys of all non-configurable own properties that have previously been observed.</p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;If the object is non-extensible, the returned <a href=\"/sec/sec-list-and-record-specification-type.html\">List</a> must contain only the keys of all own properties of the object\n        that are observable using [[GetOwnProperty]].</p>\n\n        <p class=\"normalbefore\"><b>[[Construct]] ( )</b></p>\n\n        <p class=\"normalBullet\">&#x25CF;&#xA0;&#xA0;&#xA0;The Type of the return value must be Object.</p>\n      "}