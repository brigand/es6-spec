{"id":"sec-regular-expressions-patterns","html":"\n      <h1><span class=\"secnum\" id=\"sec-B.1.4\"><a href=\"/sec/sec-regular-expressions-patterns.html\" title=\"link to this section\">B.1.4</a></span> Regular Expressions Patterns</h1>\n\n      <p>The syntax of <a href=\"/sec/sec-patterns.html\">21.2.1</a> is modified and extended as follows. These changes introduce ambiguities\n      that are broken by the ordering of grammar productions and by contextual information. When parsing using the following\n      grammar, each alternative is considered only if previous production alternatives do not match.</p>\n\n      <p>This alternative pattern grammar and semantics only changes the syntax and semantics of BMP patterns. The following\n      grammar extensions include productions parameterized with the [U] parameter. However, none of these extensions change the\n      syntax of Unicode patterns recognized when parsing with the [U] parameter present on the goal symbol.</p>\n\n      <p><b>Syntax</b></p>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">Term</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">ExtendedTerm</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">Assertion</span><sub class=\"g-params\">[U]</sub></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">Atom</span><sub class=\"g-params\">[U]</sub></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">Atom</span><sub class=\"g-params\">[U]</sub> <span class=\"nt\">Quantifier</span></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">ExtendedTerm</span> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">Assertion</span></div>\n        <div class=\"rhs\"><span class=\"nt\">AtomNoBrace</span> <span class=\"nt\">Quantifier</span></div>\n        <div class=\"rhs\"><span class=\"nt\">Atom</span></div>\n        <div class=\"rhs\"><span class=\"nt\">QuantifiableAssertion</span> <span class=\"nt\">Quantifier</span></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">AtomNoBrace</span> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">PatternCharacterNoBrace</span></div>\n        <div class=\"rhs\"><code class=\"t\">.</code></div>\n        <div class=\"rhs\"><code class=\"t\">\\</code> <span class=\"nt\">AtomEscape</span></div>\n        <div class=\"rhs\"><span class=\"nt\">CharacterClass</span></div>\n        <div class=\"rhs\"><code class=\"t\">(</code> <span class=\"nt\">Disjunction</span> <code class=\"t\">)</code></div>\n        <div class=\"rhs\"><code class=\"t\">(</code> <code class=\"t\">?</code> <code class=\"t\">:</code> <span class=\"nt\">Disjunction</span> <code class=\"t\">)</code></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">Atom</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">PatternCharacter</span></div>\n        <div class=\"rhs\"><code class=\"t\">.</code></div>\n        <div class=\"rhs\"><code class=\"t\">\\</code> <span class=\"nt\">AtomEscape</span><sub class=\"g-params\">[?U]</sub></div>\n        <div class=\"rhs\"><span class=\"nt\">CharacterClass</span><sub class=\"g-params\">[?U]</sub></div>\n        <div class=\"rhs\"><code class=\"t\">(</code> <span class=\"nt\">Disjunction</span><sub class=\"g-params\">[?U]</sub> <code class=\"t\">)</code></div>\n        <div class=\"rhs\"><code class=\"t\">(</code> <code class=\"t\">?</code> <code class=\"t\">:</code> <span class=\"nt\">Disjunction</span><sub class=\"g-params\">[?U]</sub> <code class=\"t\">)</code></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">PatternCharacterNoBrace</span> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">SourceCharacter</span> <span class=\"grhsmod\">but not one of</span></div>\n        <div class=\"rhs\"><code class=\"t\">^</code> <code class=\"t\">$</code> <code class=\"t\">\\</code> <code class=\"t\">.</code> <code class=\"t\">*</code> <code class=\"t\">+</code> <code class=\"t\">?</code> <code class=\"t\">(</code> <code class=\"t\">)</code> <code class=\"t\">[</code> <code class=\"t\">]</code> <code class=\"t\">{</code> <code class=\"t\">}</code> <code class=\"t\">|</code></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">PatternCharacter</span> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">SourceCharacter</span> <span class=\"grhsmod\">but not one of</span></div>\n        <div class=\"rhs\"><code class=\"t\">^</code> <code class=\"t\">$</code> <code class=\"t\">\\</code> <code class=\"t\">.</code> <code class=\"t\">*</code> <code class=\"t\">+</code> <code class=\"t\">?</code> <code class=\"t\">(</code> <code class=\"t\">)</code> <code class=\"t\">[</code> <code class=\"t\">]</code> <code class=\"t\">|</code></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">QuantifiableAssertion</span> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><code class=\"t\">(</code> <code class=\"t\">?</code> <code class=\"t\">=</code> <span class=\"nt\">Disjunction</span> <code class=\"t\">)</code></div>\n        <div class=\"rhs\"><code class=\"t\">(</code> <code class=\"t\">?</code> <code class=\"t\">!</code> <span class=\"nt\">Disjunction</span> <code class=\"t\">)</code></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">Assertion</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><code class=\"t\">^</code></div>\n        <div class=\"rhs\"><code class=\"t\">$</code></div>\n        <div class=\"rhs\"><code class=\"t\">\\</code> <code class=\"t\">b</code></div>\n        <div class=\"rhs\"><code class=\"t\">\\</code> <code class=\"t\">B</code></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <code class=\"t\">(</code> <code class=\"t\">?</code> <code class=\"t\">=</code> <span class=\"nt\">Disjunction</span><sub class=\"g-params\">[U]</sub> <code class=\"t\">)</code></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <code class=\"t\">(</code> <code class=\"t\">?</code> <code class=\"t\">!</code> <span class=\"nt\">Disjunction</span><sub class=\"g-params\">[U]</sub> <code class=\"t\">)</code></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">QuantifiableAssertion</span></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">AtomEscape</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">DecimalEscape</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">CharacterEscape</span><sub class=\"g-params\">[U]</sub></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">CharacterClassEscape</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">DecimalEscape</span> <code class=\"t\">but</code> <code class=\"t\">only</code> <code class=\"t\">if</code> <code class=\"t\">the</code> <code class=\"t\">integer</code> <code class=\"t\">value</code> <code class=\"t\">of</code> <span class=\"nt\">DecimalEscape</span> <code class=\"t\">is</code> <code class=\"t\">&lt;=</code> <span class=\"nt\">NCapturingParens</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">CharacterClassEscape</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">CharacterEscape</span></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">CharacterEscape</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">ControlEscape</span></div>\n        <div class=\"rhs\"><code class=\"t\">c</code> <span class=\"nt\">ControlLetter</span></div>\n        <div class=\"rhs\"><span class=\"nt\">HexEscapeSequence</span></div>\n        <div class=\"rhs\"><span class=\"nt\">RegExpUnicodeEscapeSequence</span><sub class=\"g-params\">[?U]</sub></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">LegacyOctalEscapeSequence</span></div>\n        <div class=\"rhs\"><span class=\"nt\">IdentityEscape</span><sub class=\"g-params\">[?U]</sub></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">IdentityEscape</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">SyntaxCharacter</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <code class=\"t\">/</code></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">SourceCharacter</span> <span class=\"grhsmod\">but not</span> <code class=\"t\">c</code></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">NonemptyClassRanges</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">ClassAtom</span><sub class=\"g-params\">[?U]</sub></div>\n        <div class=\"rhs\"><span class=\"nt\">ClassAtom</span><sub class=\"g-params\">[?U]</sub> <span class=\"nt\">NonemptyClassRangesNoDash</span><sub class=\"g-params\">[?U]</sub></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">ClassAtom</span><sub class=\"g-params\">[U]</sub> <code class=\"t\">-</code> <span class=\"nt\">ClassAtom</span><sub class=\"g-params\">[U]</sub> <span class=\"nt\">ClassRanges</span><sub class=\"g-params\">[U]</sub></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">ClassAtomInRange</span> <code class=\"t\">-</code> <span class=\"nt\">ClassAtomInRange</span> <span class=\"nt\">ClassRanges</span></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">NonemptyClassRangesNoDash</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">ClassAtom</span><sub class=\"g-params\">[?U]</sub></div>\n        <div class=\"rhs\"><span class=\"nt\">ClassAtomNoDash</span><sub class=\"g-params\">[?U]</sub> <span class=\"nt\">NonemptyClassRangesNoDash</span><sub class=\"g-params\">[?U]</sub></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">ClassAtomNoDash</span><sub class=\"g-params\">[U]</sub> <code class=\"t\">-</code> <span class=\"nt\">ClassAtom</span><sub class=\"g-params\">[U]</sub> <span class=\"nt\">ClassRanges</span><sub class=\"g-params\">[U]</sub></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">ClassAtomNoDashInRange</span> <code class=\"t\">-</code> <span class=\"nt\">ClassAtomInRange</span> <span class=\"nt\">ClassRanges</span></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">ClassAtom</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><code class=\"t\">-</code></div>\n        <div class=\"rhs\"><span class=\"nt\">ClassAtomNoDash</span><sub class=\"g-params\">[?U]</sub></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">ClassAtomNoDash</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">SourceCharacter</span> <span class=\"grhsmod\">but not one of</span> <code class=\"t\">\\</code> <span class=\"grhsmod\">or</span> <code class=\"t\">]</code> <span class=\"grhsmod\">or</span> <code class=\"t\">-</code></div>\n        <div class=\"rhs\"><code class=\"t\">\\</code> <span class=\"nt\">ClassEscape</span><sub class=\"g-params\">[?U]</sub></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">ClassAtomInRange</span> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><code class=\"t\">-</code></div>\n        <div class=\"rhs\"><span class=\"nt\">ClassAtomNoDashInRange</span></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">ClassAtomNoDashInRange</span> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"nt\">SourceCharacter</span> <span class=\"grhsmod\">but not one of</span> <code class=\"t\">\\</code> <span class=\"grhsmod\">or</span> <code class=\"t\">]</code> <span class=\"grhsmod\">or</span> <code class=\"t\">-</code></div>\n        <div class=\"rhs\"><code class=\"t\">\\</code> <span class=\"nt\">ClassEscape</span> <code class=\"t\">but</code> <code class=\"t\">only</code> <code class=\"t\">if</code> <span class=\"nt\">ClassEscape</span> <code class=\"t\">evaluates</code> <code class=\"t\">to</code> <code class=\"t\">a</code> <span class=\"nt\">CharSet</span> <code class=\"t\">with</code> <code class=\"t\">exactly</code> <code class=\"t\">one</code> <code class=\"t\">character</code></div>\n        <div class=\"rhs\"><code class=\"t\">\\</code> <span class=\"nt\">IdentityEscape</span></div>\n      </div>\n\n      <div class=\"gp\">\n        <div class=\"lhs\"><span class=\"nt\">ClassEscape</span><sub class=\"g-params\">[U]</sub> <span class=\"geq\">::</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">DecimalEscape</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">CharacterEscape</span><sub class=\"g-params\">[U]</sub></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[+U]</span> <span class=\"nt\">CharacterClassEscape</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">DecimalEscape</span></div>\n        <div class=\"rhs\"><code class=\"t\">b</code></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">CharacterClassEscape</span></div>\n        <div class=\"rhs\"><span class=\"grhsannot\">[~U]</span> <span class=\"nt\">CharacterEscape</span></div>\n      </div>\n\n      <div class=\"note\">\n        <p><span class=\"nh\">NOTE</span> When the same left hand sides occurs with both [+U] and [~U] guards it is to control the\n        disambiguation priority.</p>\n      </div>\n\n      <p><b>B.1.4.1</b>\t<b>Pattern Semantics</b></p>\n\n      <p>The semantics of <a href=\"/sec/sec-pattern-semantics.html\">21.2.2</a> is extended as follows:</p>\n\n      <p>Within <a href=\"/sec/sec-term.html\">21.2.2.5</a> reference to &#x201C;<span class=\"prod\"><span class=\"nt\">Atom</span> <span class=\"geq\">::</span> <code class=\"t\">(</code> <span class=\"nt\">Disjunction</span> <code class=\"t\">)</code></span> &#x201D;\n      are to be interpreted as meaning &#x201C;<span class=\"prod\"><span class=\"nt\">Atom</span> <span class=\"geq\">::</span> <code class=\"t\">(</code> <span class=\"nt\">Disjunction</span> <code class=\"t\">)</code></span> &#x201D; or &#x201C;<span class=\"prod\"><span class=\"nt\">AtomNoBrace</span> <span class=\"geq\">::</span> <code class=\"t\">(</code> <span class=\"nt\">Disjunction</span> <code class=\"t\">)</code></span> &#x201D;.</p>\n\n      <p>Term (<a href=\"/sec/sec-term.html\">21.2.2.5</a>) includes the following additional evaluation rule:</p>\n\n      <p>The production <span class=\"prod\"><span class=\"nt\">Term</span> <span class=\"geq\">::</span> <span class=\"nt\">QuantifiableAssertion</span> <span class=\"nt\">Quantifier</span></span> evaluates the same as the production <span class=\"prod\"><span class=\"nt\">Term</span> <span class=\"geq\">::</span> <span class=\"nt\">Atom</span> <span class=\"nt\">Quantifier</span></span> but with <span class=\"nt\">QuantifiableAssertion</span> substituted for <span style=\"font-family: Times New Roman\"><i>Atom</i>.</span></p>\n\n      <p>Atom (<a href=\"/sec/sec-atom.html\">21.2.2.8</a>) evaluation rules for the <span class=\"nt\">Atom</span> productions except for\n      <span class=\"prod\"><span class=\"nt\">Atom</span> <span class=\"geq\">::</span> <span class=\"nt\">PatternCharacter</span></span>\n      are also used for the <span class=\"nt\">AtomNoBrace</span> productions, but with <span class=\"nt\">AtomNoBrace</span>\n      substituted for <span style=\"font-family: Times New Roman\"><i>Atom</i>.</span> The following evaluation rule is also\n      added:</p>\n\n      <p class=\"normalbefore\">The production <span class=\"prod\"><span class=\"nt\">AtomNoBrace</span> <span class=\"geq\">::</span>\n      <span class=\"nt\">PatternCharacterNoBrace</span></span> evaluates as follows:</p>\n\n      <ol class=\"proc\">\n        <li>Let <i>ch</i> be the character represented by <i>PatternCharacterNoBrace</i>.</li>\n        <li>Let <i>A</i> be a one-element CharSet containing the character <i>ch</i>.</li>\n        <li><a href=\"/sec/sec-call.html\">Call</a> CharacterSetMatcher(<i>A</i>, <b>false</b>) and return its Matcher result.</li>\n      </ol>\n\n      <p>CharacterEscape (<a href=\"/sec/sec-characterescape.html\">21.2.2.10</a>) includes the following additional evaluation rule:</p>\n\n      <p>The production <span class=\"prod\"><span class=\"nt\">CharacterEscape</span> <span class=\"geq\">::</span> <span class=\"nt\">LegacyOctalEscapeSequence</span></span> evaluates by evaluating the SV of the <span class=\"nt\">LegacyOctalEscapeSequence</span> (<a href=\"/sec/sec-additional-syntax-string-literals.html\">see B.1.2</a>) and returning\n      its character result.</p>\n\n      <p>ClassAtom (<a href=\"/sec/sec-classatom.html\">21.2.2.17</a>) includes the following additional evaluation rules:</p>\n\n      <p>The production <span class=\"prod\"><span class=\"nt\">ClassAtomInRange</span> <span class=\"geq\">::</span> <code class=\"t\">-</code></span> evaluates by returning the CharSet containing the one character <code>-</code>.</p>\n\n      <p>The production <span class=\"prod\"><span class=\"nt\">ClassAtomInRange</span> <span class=\"geq\">::</span> <span class=\"nt\">ClassAtomNoDashInRange</span></span> evaluates by evaluating <span class=\"nt\">ClassAtomNoDashInRange</span> to\n      obtain a CharSet and returning that CharSet.</p>\n\n      <p>ClassAtomNoDash (<a href=\"/sec/sec-classatomnodash.html\">21.2.2.18</a>) includes the following additional evaluation rules:</p>\n\n      <p>The production <span class=\"prod\"><span class=\"nt\">ClassAtomNoDashInRange</span> <span class=\"geq\">::</span> <span class=\"nt\">SourceCharacter</span> <span class=\"grhsmod\">but not one of</span> <code class=\"t\">\\</code> <span class=\"grhsmod\">or</span> <code class=\"t\">]</code> <span class=\"grhsmod\">or</span> <code class=\"t\">-</code></span> evaluates\n      by returning a one-element CharSet containing the character represented by <span class=\"nt\">SourceCharacter</span>.</p>\n\n      <p>The production <span class=\"prod\"><span class=\"nt\">ClassAtomNoDashInRange</span> <span class=\"geq\">::</span> <code class=\"t\">\\</code> <span class=\"nt\">ClassEscape</span></span> but only if&#x2026;, evaluates by evaluating <span class=\"nt\">ClassEscape</span> to obtain a CharSet and returning that CharSet.</p>\n\n      <p>The production <span class=\"prod\"><span class=\"nt\">ClassAtomNoDashInRange</span> <span class=\"geq\">::</span> <code class=\"t\">\\</code> <span class=\"nt\">IdentityEscape</span></span> evaluates by returning the character represented by <span class=\"nt\">IdentityEscape</span>.</p>\n    "}